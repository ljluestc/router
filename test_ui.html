<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoAccept UI Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1e1e1e;
            color: #ccc;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
            background: #252525;
        }
        .button {
            display: inline-block;
            padding: 8px 16px;
            margin: 5px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        .button:hover {
            background: #45a049;
        }
        .button.secondary {
            background: #2196F3;
        }
        .button.secondary:hover {
            background: #1976D2;
        }
        .button.warning {
            background: #FF9800;
        }
        .button.warning:hover {
            background: #e68900;
        }
        .log {
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            height: 200px;
            overflow-y: auto;
            margin: 10px 0;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-weight: bold;
        }
        .status.running {
            background: #4CAF50;
            color: white;
        }
        .status.stopped {
            background: #f44336;
            color: white;
        }
    </style>
</head>
<body>
    <h1>AutoAccept Script UI Test</h1>
    
    <div class="test-section">
        <h2>Control Panel Test</h2>
        <p>This tests the control panel creation and functionality.</p>
        <button class="button" onclick="testControlPanel()">Show Control Panel</button>
        <button class="button secondary" onclick="testHidePanel()">Hide Control Panel</button>
    </div>
    
    <div class="test-section">
        <h2>Button Detection Test</h2>
        <p>This tests the button detection logic with mock buttons.</p>
        <button class="button" onclick="testButtonDetection()">Test Button Detection</button>
        <button class="button secondary" onclick="testSequenceHandling()">Test Sequence Handling</button>
    </div>
    
    <div class="test-section">
        <h2>Mock Cursor IDE Interface</h2>
        <p>Simulating Cursor IDE interface with various button types:</p>
        
        <div class="composer-code-block-container" style="margin: 10px 0; padding: 10px; border: 1px solid #555; border-radius: 4px;">
            <div class="composer-code-block-filename">
                <span>test-file.js</span>
            </div>
            <div class="composer-code-block-status">
                <span style="color: #4CAF50;">+15 -3</span>
            </div>
            <div style="margin-top: 10px;">
                <button class="button" onclick="simulateAccept()">Accept</button>
                <button class="button secondary" onclick="simulateKeep()">Keep</button>
                <button class="button warning" onclick="simulateRun()">Run</button>
                <button class="button" onclick="simulateApply()">Apply</button>
            </div>
        </div>
        
        <div class="composer-code-block-container" style="margin: 10px 0; padding: 10px; border: 1px solid #555; border-radius: 4px;">
            <div class="composer-code-block-filename">
                <span>another-file.py</span>
            </div>
            <div class="composer-code-block-status">
                <span style="color: #4CAF50;">+8 -2</span>
            </div>
            <div style="margin-top: 10px;">
                <button class="button" onclick="simulateAcceptAll()">Accept All</button>
                <button class="button secondary" onclick="simulateReviewNext()">Review Next File</button>
            </div>
        </div>
    </div>
    
    <div class="test-section">
        <h2>AutoAccept Script Controls</h2>
        <div class="status" id="status">Stopped</div>
        <button class="button" onclick="startScript()">Start AutoAccept</button>
        <button class="button secondary" onclick="stopScript()">Stop AutoAccept</button>
        <button class="button warning" onclick="toggleDebug()">Toggle Debug</button>
        <button class="button" onclick="clearLog()">Clear Log</button>
    </div>
    
    <div class="test-section">
        <h2>Test Log</h2>
        <div class="log" id="log"></div>
    </div>

    <script>
        // Load the AutoAccept script
        const script = document.createElement('script');
        script.src = 'original.js';
        document.head.appendChild(script);
        
        // Test functions
        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }
        
        function testControlPanel() {
            log('Testing control panel creation...');
            if (typeof globalThis.simpleAccept !== 'undefined') {
                globalThis.simpleAccept.showControlPanel();
                log('✓ Control panel shown');
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function testHidePanel() {
            log('Testing control panel hiding...');
            if (typeof globalThis.simpleAccept !== 'undefined') {
                globalThis.simpleAccept.hideControlPanel();
                log('✓ Control panel hidden');
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function testButtonDetection() {
            log('Testing button detection...');
            if (typeof globalThis.simpleAccept !== 'undefined') {
                const buttons = globalThis.simpleAccept.findAcceptButtons();
                log(`Found ${buttons.length} buttons:`);
                buttons.forEach((btn, i) => {
                    log(`  ${i+1}. "${btn.textContent.trim()}" (${btn.tagName})`);
                });
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function testSequenceHandling() {
            log('Testing sequence handling...');
            if (typeof globalThis.simpleAccept !== 'undefined') {
                const buttons = globalThis.simpleAccept.findAcceptButtons();
                if (buttons.length > 0) {
                    const clicked = globalThis.simpleAccept.clickButtonsInSequence(buttons);
                    if (clicked) {
                        log(`✓ Clicked: "${clicked.textContent.trim()}"`);
                    } else {
                        log('✗ No button was clicked');
                    }
                } else {
                    log('✗ No buttons found to test');
                }
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function startScript() {
            log('Starting AutoAccept script...');
            if (typeof globalThis.startAccept !== 'undefined') {
                globalThis.startAccept();
                document.getElementById('status').textContent = 'Running';
                document.getElementById('status').className = 'status running';
                log('✓ AutoAccept started');
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function stopScript() {
            log('Stopping AutoAccept script...');
            if (typeof globalThis.stopAccept !== 'undefined') {
                globalThis.stopAccept();
                document.getElementById('status').textContent = 'Stopped';
                document.getElementById('status').className = 'status stopped';
                log('✓ AutoAccept stopped');
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function toggleDebug() {
            log('Toggling debug mode...');
            if (typeof globalThis.toggleDebug !== 'undefined') {
                const debugMode = globalThis.toggleDebug();
                log(`✓ Debug mode: ${debugMode ? 'ON' : 'OFF'}`);
            } else {
                log('✗ AutoAccept script not loaded yet');
            }
        }
        
        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }
        
        // Simulation functions for button clicks
        function simulateAccept() {
            log('Simulated: Accept button clicked');
        }
        
        function simulateKeep() {
            log('Simulated: Keep button clicked');
        }
        
        function simulateRun() {
            log('Simulated: Run button clicked');
        }
        
        function simulateApply() {
            log('Simulated: Apply button clicked');
        }
        
        function simulateAcceptAll() {
            log('Simulated: Accept All button clicked');
        }
        
        function simulateReviewNext() {
            log('Simulated: Review Next File button clicked');
        }
        
        // Wait for script to load
        script.onload = function() {
            log('✓ AutoAccept script loaded successfully');
            log('Ready for testing!');
        };
        
        script.onerror = function() {
            log('✗ Failed to load AutoAccept script');
        };
    </script>
</body>
</html>
