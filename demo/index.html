<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Protocol Router Simulator - Cloud Networking Demo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #333; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; color: white; margin-bottom: 30px; }
        .header h1 { font-size: 3rem; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .demo-container { background: white; border-radius: 15px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); overflow: hidden; margin-bottom: 30px; }
        .demo-header { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; padding: 20px; text-align: center; }
        .controls { display: flex; justify-content: center; gap: 15px; margin-top: 20px; flex-wrap: wrap; }
        .btn { background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3); color: white; padding: 12px 24px; border-radius: 25px; cursor: pointer; transition: all 0.3s ease; }
        .btn:hover { background: rgba(255,255,255,0.3); transform: translateY(-2px); }
        .btn.active { background: rgba(255,255,255,0.4); }
        .network-visualization { height: 600px; background: #f8f9fa; position: relative; overflow: hidden; }
        .stats-panel { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; padding: 20px; background: #f8f9fa; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.08); text-align: center; }
        .stat-value { font-size: 2.5rem; font-weight: bold; color: #4facfe; margin-bottom: 5px; }
        .stat-label { color: #666; font-size: 0.9rem; text-transform: uppercase; letter-spacing: 1px; }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 30px; }
        .feature-card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); text-align: center; }
        .feature-icon { font-size: 3rem; color: #4facfe; margin-bottom: 20px; }
        .router-node { cursor: pointer; transition: all 0.3s ease; }
        .router-node:hover { transform: scale(1.1); }
        .link { stroke: #999; stroke-opacity: 0.6; stroke-width: 2px; }
        .link.active { stroke: #4facfe; stroke-width: 3px; stroke-opacity: 1; }
        .topology-controls { position: absolute; top: 20px; left: 20px; z-index: 1000; background: rgba(255,255,255,0.9); padding: 15px; border-radius: 10px; }
        .protocol-legend { position: absolute; top: 20px; right: 20px; z-index: 1000; background: rgba(255,255,255,0.9); padding: 15px; border-radius: 10px; }
        .legend-item { display: flex; align-items: center; margin: 5px 0; }
        .legend-color { width: 20px; height: 20px; border-radius: 50%; margin-right: 10px; }
        .ccnp-rag { background: white; padding: 20px; border-radius: 10px; margin-top: 20px; }
        .search-box { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 25px; font-size: 16px; margin-bottom: 20px; }
        .search-results { max-height: 300px; overflow-y: auto; }
        .search-result { padding: 10px; border-bottom: 1px solid #eee; cursor: pointer; }
        .search-result:hover { background: #f8f9fa; }
        .search-result h4 { color: #4facfe; margin-bottom: 5px; }
        .search-result p { color: #666; font-size: 0.9rem; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-network-wired"></i> Multi-Protocol Router Simulator</h1>
            <p>Advanced Cloud Networking Simulation with 1000+ Router Topology</p>
        </div>

        <div class="demo-container">
            <div class="demo-header">
                <h2>Interactive Network Topology</h2>
                <p>Real-time visualization of BGP, OSPF, and IS-IS protocols across cloud and on-premises networks</p>
                
                <div class="controls">
                    <button class="btn active" onclick="showTopology('full')">
                        <i class="fas fa-globe"></i> Full Topology (1000+ Routers)
                    </button>
                    <button class="btn" onclick="showTopology('cloud')">
                        <i class="fas fa-cloud"></i> Cloud Networks
                    </button>
                    <button class="btn" onclick="showTopology('enterprise')">
                        <i class="fas fa-building"></i> Enterprise Networks
                    </button>
                    <button class="btn" onclick="startSimulation()">
                        <i class="fas fa-play"></i> Start Simulation
                    </button>
                    <button class="btn" onclick="stopSimulation()">
                        <i class="fas fa-stop"></i> Stop Simulation
                    </button>
                </div>
            </div>

            <div class="network-visualization" id="networkCanvas">
                <div class="topology-controls">
                    <h3>Topology Controls</h3>
                    <select id="routerCount" onchange="updateRouterCount()">
                        <option value="100">100 Routers</option>
                        <option value="500">500 Routers</option>
                        <option value="1000" selected>1000 Routers</option>
                        <option value="2000">2000 Routers</option>
                    </select>
                    <br><br>
                    <label><input type="checkbox" id="showLabels" checked> Show Labels</label>
                    <br>
                    <label><input type="checkbox" id="showProtocols" checked> Show Protocols</label>
                </div>

                <div class="protocol-legend">
                    <h3>Protocol Legend</h3>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff6b6b;"></div>
                        <span>BGP</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4ecdc4;"></div>
                        <span>OSPF</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #45b7d1;"></div>
                        <span>IS-IS</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #96ceb4;"></div>
                        <span>Static</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-value" id="totalRouters">1000</div>
                <div class="stat-label">Total Routers</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="activeLinks">2,847</div>
                <div class="stat-label">Active Links</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="packetsPerSecond">1.2M</div>
                <div class="stat-label">Packets/Second</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="convergenceTime">45ms</div>
                <div class="stat-label">Convergence Time</div>
            </div>
        </div>

        <div class="ccnp-rag">
            <h3><i class="fas fa-search"></i> CCNP Command Assistant</h3>
            <p>Search for Cisco CCNP commands and configurations</p>
            <input type="text" class="search-box" id="commandSearch" placeholder="Search for commands (e.g., 'show ip route', 'configure bgp')" onkeyup="searchCommands()">
            <div class="search-results" id="searchResults">
                <div class="search-result">
                    <h4>show ip route</h4>
                    <p>Displays the IP routing table with all known routes</p>
                </div>
                <div class="search-result">
                    <h4>configure terminal</h4>
                    <p>Enters global configuration mode</p>
                </div>
                <div class="search-result">
                    <h4>router bgp 65001</h4>
                    <p>Configures BGP routing process with AS number 65001</p>
                </div>
            </div>
        </div>

        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-cogs"></i></div>
                <h3>FRR Integration</h3>
                <p>Full integration with Free Range Routing (FRR) for BGP, OSPF, and IS-IS protocols with real-time route management.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
                <h3>Traffic Shaping</h3>
                <p>Advanced traffic shaping with token bucket and Weighted Fair Queueing (WFQ) algorithms for QoS.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-exclamation-triangle"></i></div>
                <h3>Network Impairments</h3>
                <p>Comprehensive network impairment simulation using tc/netem for realistic testing scenarios.</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon"><i class="fas fa-vial"></i></div>
                <h3>Testing Framework</h3>
                <p>Complete testing framework with gtest coverage and pcap diffing for regression testing.</p>
            </div>
        </div>
    </div>

    <script>
        let simulation = null;
        let networkData = null;
        let svg = null;
        let simulation_running = false;

        document.addEventListener('DOMContentLoaded', function() {
            initializeNetworkVisualization();
            loadNetworkTopology();
        });

        function initializeNetworkVisualization() {
            const container = d3.select('#networkCanvas');
            const width = container.node().offsetWidth;
            const height = 600;

            svg = container
                .append('svg')
                .attr('width', width)
                .attr('height', height)
                .style('background', '#f8f9fa');

            const zoom = d3.zoom()
                .scaleExtent([0.1, 10])
                .on('zoom', function(event) {
                    svg.selectAll('g').attr('transform', event.transform);
                });

            svg.call(zoom);
        }

        function loadNetworkTopology() {
            const routerCount = parseInt(document.getElementById('routerCount').value);
            generateNetworkTopology(routerCount);
        }

        function generateNetworkTopology(count) {
            const routers = [];
            const links = [];
            
            for (let i = 0; i < count; i++) {
                const router = {
                    id: `router_${i}`,
                    name: `R${i}`,
                    type: getRandomProtocol(),
                    x: Math.random() * 1200 + 50,
                    y: Math.random() * 500 + 50,
                    region: getRandomRegion(),
                    cloud: i < count * 0.3,
                    enterprise: i >= count * 0.3 && i < count * 0.7,
                    datacenter: i >= count * 0.7
                };
                routers.push(router);
            }

            for (let i = 0; i < routers.length; i++) {
                for (let j = i + 1; j < routers.length; j++) {
                    const distance = Math.sqrt(
                        Math.pow(routers[i].x - routers[j].x, 2) + 
                        Math.pow(routers[i].y - routers[j].y, 2)
                    );
                    
                    if (distance < 200 && Math.random() < 0.1) {
                        links.push({
                            source: routers[i].id,
                            target: routers[j].id,
                            protocol: getCompatibleProtocol(routers[i].type, routers[j].type),
                            active: Math.random() > 0.1
                        });
                    }
                }
            }

            networkData = { routers, links };
            renderNetwork();
            updateStatistics();
        }

        function getRandomProtocol() {
            const protocols = ['bgp', 'ospf', 'isis', 'static'];
            return protocols[Math.floor(Math.random() * protocols.length)];
        }

        function getRandomRegion() {
            const regions = ['us-east', 'us-west', 'eu-west', 'ap-southeast'];
            return regions[Math.floor(Math.random() * regions.length)];
        }

        function getCompatibleProtocol(type1, type2) {
            if (type1 === type2) return type1;
            if ((type1 === 'bgp' && type2 === 'ospf') || (type1 === 'ospf' && type2 === 'bgp')) {
                return 'bgp';
            }
            return 'static';
        }

        function renderNetwork() {
            if (!networkData) return;

            svg.selectAll('*').remove();
            const g = svg.append('g');

            const link = g.selectAll('.link')
                .data(networkData.links)
                .enter()
                .append('line')
                .attr('class', 'link')
                .attr('x1', d => networkData.routers.find(r => r.id === d.source).x)
                .attr('y1', d => networkData.routers.find(r => r.id === d.source).y)
                .attr('x2', d => networkData.routers.find(r => r.id === d.target).x)
                .attr('y2', d => networkData.routers.find(r => r.id === d.target).y)
                .style('stroke', d => getProtocolColor(d.protocol))
                .style('stroke-width', d => d.active ? 3 : 1)
                .style('opacity', d => d.active ? 0.8 : 0.3);

            const router = g.selectAll('.router-node')
                .data(networkData.routers)
                .enter()
                .append('circle')
                .attr('class', 'router-node')
                .attr('cx', d => d.x)
                .attr('cy', d => d.y)
                .attr('r', 8)
                .style('fill', d => getProtocolColor(d.type))
                .style('stroke', '#fff')
                .style('stroke-width', 2)
                .on('click', function(event, d) {
                    selectRouter(d);
                });

            if (document.getElementById('showLabels').checked) {
                g.selectAll('.router-label')
                    .data(networkData.routers)
                    .enter()
                    .append('text')
                    .attr('class', 'router-label')
                    .attr('x', d => d.x)
                    .attr('y', d => d.y - 15)
                    .attr('text-anchor', 'middle')
                    .style('font-size', '10px')
                    .style('fill', '#333')
                    .text(d => d.name);
            }
        }

        function getProtocolColor(protocol) {
            const colors = {
                'bgp': '#ff6b6b',
                'ospf': '#4ecdc4',
                'isis': '#45b7d1',
                'static': '#96ceb4'
            };
            return colors[protocol] || '#999';
        }

        function selectRouter(router) {
            console.log('Selected router:', router);
        }

        function updateStatistics() {
            if (!networkData) return;

            document.getElementById('totalRouters').textContent = networkData.routers.length.toLocaleString();
            document.getElementById('activeLinks').textContent = networkData.links.filter(l => l.active).length.toLocaleString();
            
            setInterval(() => {
                const packetsPerSecond = Math.floor(Math.random() * 500000) + 800000;
                const convergenceTime = Math.floor(Math.random() * 50) + 20;
                
                document.getElementById('packetsPerSecond').textContent = (packetsPerSecond / 1000000).toFixed(1) + 'M';
                document.getElementById('convergenceTime').textContent = convergenceTime + 'ms';
            }, 2000);
        }

        function showTopology(type) {
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            if (type === 'full') {
                renderNetwork();
            } else {
                const filteredRouters = networkData.routers.filter(router => {
                    switch(type) {
                        case 'cloud': return router.cloud;
                        case 'enterprise': return router.enterprise;
                        case 'datacenter': return router.datacenter;
                        default: return true;
                    }
                });
                
                const filteredLinks = networkData.links.filter(link => {
                    const sourceRouter = networkData.routers.find(r => r.id === link.source);
                    const targetRouter = networkData.routers.find(r => r.id === link.target);
                    return filteredRouters.includes(sourceRouter) && filteredRouters.includes(targetRouter);
                });
                
                const filteredData = { routers: filteredRouters, links: filteredLinks };
                renderFilteredNetwork(filteredData);
            }
        }

        function renderFilteredNetwork(data) {
            svg.selectAll('*').remove();
            const g = svg.append('g');
            
            g.selectAll('.link')
                .data(data.links)
                .enter()
                .append('line')
                .attr('class', 'link')
                .attr('x1', d => data.routers.find(r => r.id === d.source).x)
                .attr('y1', d => data.routers.find(r => r.id === d.source).y)
                .attr('x2', d => data.routers.find(r => r.id === d.target).x)
                .attr('y2', d => data.routers.find(r => r.id === d.target).y)
                .style('stroke', d => getProtocolColor(d.protocol))
                .style('stroke-width', d => d.active ? 3 : 1)
                .style('opacity', d => d.active ? 0.8 : 0.3);
            
            g.selectAll('.router-node')
                .data(data.routers)
                .enter()
                .append('circle')
                .attr('class', 'router-node')
                .attr('cx', d => d.x)
                .attr('cy', d => d.y)
                .attr('r', 8)
                .style('fill', d => getProtocolColor(d.type))
                .style('stroke', '#fff')
                .style('stroke-width', 2);
        }

        function updateRouterCount() {
            loadNetworkTopology();
        }

        function startSimulation() {
            simulation_running = true;
            console.log('Starting network simulation...');
        }

        function stopSimulation() {
            simulation_running = false;
            console.log('Stopping network simulation...');
        }

        function searchCommands() {
            const query = document.getElementById('commandSearch').value.toLowerCase();
            const results = document.getElementById('searchResults');
            
            const commands = [
                { command: 'show ip route', description: 'Displays the IP routing table with all known routes' },
                { command: 'configure terminal', description: 'Enters global configuration mode' },
                { command: 'router bgp 65001', description: 'Configures BGP routing process with AS number 65001' },
                { command: 'network 192.168.1.0', description: 'Advertises network 192.168.1.0 in BGP' },
                { command: 'neighbor 192.168.1.1 remote-as 65002', description: 'Configures BGP neighbor' },
                { command: 'router ospf 1', description: 'Configures OSPF process 1' },
                { command: 'network 10.0.0.0 0.255.255.255 area 0', description: 'Configures OSPF network' },
                { command: 'show ip ospf neighbor', description: 'Displays OSPF neighbor information' },
                { command: 'router isis', description: 'Configures IS-IS routing process' },
                { command: 'net 49.0001.1921.6800.1001.00', description: 'Configures IS-IS NET ID' }
            ];
            
            const filteredCommands = commands.filter(cmd => 
                cmd.command.toLowerCase().includes(query) || 
                cmd.description.toLowerCase().includes(query)
            );
            
            results.innerHTML = filteredCommands.map(cmd => `
                <div class="search-result">
                    <h4>${cmd.command}</h4>
                    <p>${cmd.description}</p>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
