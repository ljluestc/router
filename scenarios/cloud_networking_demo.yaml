name: "Cloud Networking Demo"
description: "Comprehensive multi-cloud networking simulation with CloudPods and Aviatrix integration"
version: "1.0.0"
author: "Router Simulator Team"

# Global configuration
global:
  simulation_duration: 300  # seconds
  log_level: "info"
  metrics_enabled: true
  analytics_enabled: true

# Cloud providers configuration
cloud_providers:
  cloudpods:
    enabled: true
    endpoint: "https://cloudpods.example.com"
    username: "admin"
    password: "password"
    region: "us-west-1"
    resources:
      - type: "vpc"
        name: "demo-vpc"
        cidr: "10.0.0.0/16"
        subnets:
          - name: "public-subnet"
            cidr: "10.0.1.0/24"
            zone: "us-west-1a"
          - name: "private-subnet"
            cidr: "10.0.2.0/24"
            zone: "us-west-1b"
      - type: "instance"
        name: "web-server"
        instance_type: "t3.medium"
        image_id: "ami-12345678"
        subnet: "public-subnet"
        security_groups: ["web-sg"]
      - type: "load_balancer"
        name: "web-lb"
        type: "application"
        scheme: "internet-facing"
        listeners:
          - protocol: "HTTP"
            port: 80
            target_group: "web-tg"

  aviatrix:
    enabled: true
    controller_ip: "1.2.3.4"
    username: "admin"
    password: "password"
    region: "us-east-1"
    gateways:
      - name: "transit-gateway"
        type: "transit"
        cloud_type: 1  # AWS
        account_name: "aws-account"
        region: "us-east-1"
        vpc_id: "vpc-12345678"
        gateway_size: "t3.medium"
        enable_encryption: true
        enable_nat: true
        bgp_manual_spoke: true
        local_as_number: "65001"
      - name: "spoke-gateway-1"
        type: "spoke"
        cloud_type: 1  # AWS
        account_name: "aws-account"
        region: "us-west-1"
        vpc_id: "vpc-87654321"
        gateway_size: "t3.small"
        enable_encryption: true
        enable_nat: false
        bgp_manual_spoke: true
        local_as_number: "65002"

# Network topology
network_topology:
  nodes:
    - id: "cloudpods-region"
      type: "cloud"
      name: "CloudPods US-West-1"
      provider: "cloudpods"
      region: "us-west-1"
      position: { x: 100, y: 100 }
      properties:
        vpc_id: "vpc-cloudpods"
        cidr: "10.0.0.0/16"
    
    - id: "aviatrix-transit"
      type: "gateway"
      name: "Aviatrix Transit Gateway"
      provider: "aviatrix"
      region: "us-east-1"
      position: { x: 300, y: 100 }
      properties:
        gateway_name: "transit-gateway"
        asn: 65001
    
    - id: "aviatrix-spoke"
      type: "gateway"
      name: "Aviatrix Spoke Gateway"
      provider: "aviatrix"
      region: "us-west-1"
      position: { x: 500, y: 100 }
      properties:
        gateway_name: "spoke-gateway-1"
        asn: 65002
    
    - id: "bgp-router"
      type: "router"
      name: "BGP Router"
      protocol: "bgp"
      position: { x: 700, y: 100 }
      properties:
        asn: 65003
        router_id: "192.168.1.1"
    
    - id: "ospf-router"
      type: "router"
      name: "OSPF Router"
      protocol: "ospf"
      position: { x: 900, y: 100 }
      properties:
        area_id: "0.0.0.0"
        router_id: "192.168.2.1"
    
    - id: "web-server"
      type: "server"
      name: "Web Server"
      position: { x: 1100, y: 100 }
      properties:
        service: "web"
        port: 80
        ip_address: "192.168.3.10"

  edges:
    - id: "cloudpods-to-transit"
      source: "cloudpods-region"
      target: "aviatrix-transit"
      type: "cloud"
      properties:
        connection_type: "vpn"
        bandwidth: 1000  # Mbps
        latency: 15      # ms
    
    - id: "transit-to-spoke"
      source: "aviatrix-transit"
      target: "aviatrix-spoke"
      type: "bgp"
      properties:
        connection_type: "transit-peering"
        bandwidth: 10000  # Mbps
        latency: 2        # ms
    
    - id: "spoke-to-bgp"
      source: "aviatrix-spoke"
      target: "bgp-router"
      type: "bgp"
      properties:
        connection_type: "ebgp"
        bandwidth: 1000   # Mbps
        latency: 1        # ms
    
    - id: "bgp-to-ospf"
      source: "bgp-router"
      target: "ospf-router"
      type: "ospf"
      properties:
        connection_type: "redistribution"
        bandwidth: 1000   # Mbps
        latency: 1        # ms
    
    - id: "ospf-to-server"
      source: "ospf-router"
      target: "web-server"
      type: "ospf"
      properties:
        connection_type: "intra-area"
        bandwidth: 100    # Mbps
        latency: 1        # ms

# Routing protocols configuration
routing_protocols:
  bgp:
    enabled: true
    local_as: 65003
    router_id: "192.168.1.1"
    neighbors:
      - address: "192.168.1.2"
        remote_as: 65002
        hold_time: 180
        keepalive_interval: 60
        password: "bgp-password"
    advertised_routes:
      - prefix: "192.168.3.0/24"
        next_hop: "192.168.1.1"
        metric: 100
        communities: ["65003:100"]
    import_policies:
      - name: "accept-all"
        action: "accept"
        conditions: []
    export_policies:
      - name: "advertise-local"
        action: "accept"
        conditions:
          - type: "local"
            value: true

  ospf:
    enabled: true
    area_id: "0.0.0.0"
    router_id: "192.168.2.1"
    interfaces:
      - name: "eth0"
        network: "192.168.2.0/24"
        cost: 10
        priority: 1
        hello_interval: 10
        dead_interval: 40
    advertised_routes:
      - prefix: "192.168.3.0/24"
        cost: 10
        type: "intra-area"

  isis:
    enabled: false
    system_id: "1921.6802.0001"
    area_id: "49.0001"
    level: 2
    interfaces:
      - name: "eth1"
        level: 2
        metric: 10
        hello_interval: 10
        hold_time: 30

# Traffic shaping configuration
traffic_shaping:
  enabled: true
  algorithms:
    - name: "token_bucket"
      type: "token_bucket"
      parameters:
        capacity: 1000000      # bytes
        refill_rate: 100000    # bytes per second
        burst_size: 1500       # bytes
    
    - name: "wfq"
      type: "wfq"
      parameters:
        max_queues: 8
        queue_weights:
          - queue_id: 0
            weight: 1
          - queue_id: 1
            weight: 2
          - queue_id: 2
            weight: 4
          - queue_id: 3
            weight: 8
    
    - name: "drr"
      type: "drr"
      parameters:
        max_queues: 8
        quantums:
          - queue_id: 0
            quantum: 1500
          - queue_id: 1
            quantum: 3000
          - queue_id: 2
            quantum: 6000
          - queue_id: 3
            quantum: 12000
    
    - name: "htb"
      type: "htb"
      parameters:
        max_classes: 8
        classes:
          - class_id: 0
            rate: 1000000      # bytes per second
            ceil: 2000000      # bytes per second
            burst: 1500        # bytes
            priority: 1

# Network impairments configuration
network_impairments:
  enabled: true
  impairments:
    - name: "packet_loss"
      type: "packet_loss"
      interface: "eth0"
      parameters:
        percentage: 0.1
      schedule:
        start_time: 60    # seconds
        duration: 30      # seconds
    
    - name: "latency"
      type: "latency"
      interface: "eth1"
      parameters:
        delay: 50         # ms
        jitter: 10        # ms
      schedule:
        start_time: 120   # seconds
        duration: 60      # seconds
    
    - name: "bandwidth_limit"
      type: "bandwidth"
      interface: "eth2"
      parameters:
        bandwidth: 100    # Mbps
      schedule:
        start_time: 180   # seconds
        duration: 90      # seconds
    
    - name: "packet_duplication"
      type: "duplication"
      interface: "eth0"
      parameters:
        percentage: 0.05
      schedule:
        start_time: 240   # seconds
        duration: 30      # seconds

# Traffic generation
traffic_generation:
  enabled: true
  flows:
    - name: "web_traffic"
      source: "cloudpods-region"
      destination: "web-server"
      protocol: "HTTP"
      rate: 1000          # packets per second
      packet_size: 1024   # bytes
      duration: 300       # seconds
      start_time: 10      # seconds
    
    - name: "bgp_updates"
      source: "aviatrix-transit"
      destination: "bgp-router"
      protocol: "BGP"
      rate: 10            # updates per second
      packet_size: 1500   # bytes
      duration: 300       # seconds
      start_time: 5       # seconds
    
    - name: "ospf_hello"
      source: "ospf-router"
      destination: "bgp-router"
      protocol: "OSPF"
      rate: 1             # hello packets per second
      packet_size: 64     # bytes
      duration: 300       # seconds
      start_time: 5       # seconds

# Security policies
security_policies:
  firewall:
    enabled: true
    rules:
      - name: "allow_http"
        action: "allow"
        source: "0.0.0.0/0"
        destination: "192.168.3.0/24"
        protocol: "TCP"
        port: "80"
        description: "Allow HTTP traffic to web servers"
      
      - name: "allow_https"
        action: "allow"
        source: "0.0.0.0/0"
        destination: "192.168.3.0/24"
        protocol: "TCP"
        port: "443"
        description: "Allow HTTPS traffic to web servers"
      
      - name: "allow_bgp"
        action: "allow"
        source: "192.168.1.0/24"
        destination: "192.168.1.0/24"
        protocol: "TCP"
        port: "179"
        description: "Allow BGP traffic between routers"
      
      - name: "allow_ospf"
        action: "allow"
        source: "192.168.2.0/24"
        destination: "224.0.0.5"
        protocol: "UDP"
        port: "89"
        description: "Allow OSPF multicast traffic"
      
      - name: "deny_ssh"
        action: "deny"
        source: "0.0.0.0/0"
        destination: "192.168.0.0/16"
        protocol: "TCP"
        port: "22"
        description: "Deny SSH access from external networks"

  acl:
    enabled: true
    rules:
      - name: "permit_established"
        action: "permit"
        source: "any"
        destination: "any"
        protocol: "TCP"
        flags: "established"
        description: "Permit established TCP connections"
      
      - name: "deny_fragments"
        action: "deny"
        source: "any"
        destination: "any"
        protocol: "any"
        flags: "fragment"
        description: "Deny fragmented packets"

# Monitoring and analytics
monitoring:
  enabled: true
  metrics:
    - name: "packet_count"
      type: "counter"
      description: "Total packets processed"
      labels: ["interface", "protocol"]
    
    - name: "byte_count"
      type: "counter"
      description: "Total bytes processed"
      labels: ["interface", "protocol"]
    
    - name: "packet_loss"
      type: "gauge"
      description: "Packet loss percentage"
      labels: ["interface"]
    
    - name: "latency"
      type: "histogram"
      description: "Packet latency distribution"
      labels: ["interface", "protocol"]
      buckets: [1, 5, 10, 25, 50, 100, 250, 500, 1000]
    
    - name: "queue_depth"
      type: "gauge"
      description: "Traffic shaping queue depth"
      labels: ["algorithm", "queue_id"]
    
    - name: "route_count"
      type: "gauge"
      description: "Number of routes in routing table"
      labels: ["protocol"]
    
    - name: "neighbor_count"
      type: "gauge"
      description: "Number of active neighbors"
      labels: ["protocol"]

  alerts:
    - name: "high_packet_loss"
      condition: "packet_loss > 1.0"
      severity: "warning"
      description: "Packet loss exceeds 1%"
    
    - name: "high_latency"
      condition: "latency_p99 > 100"
      severity: "warning"
      description: "99th percentile latency exceeds 100ms"
    
    - name: "queue_overflow"
      condition: "queue_depth > 1000"
      severity: "critical"
      description: "Traffic shaping queue overflow"
    
    - name: "neighbor_down"
      condition: "neighbor_count < expected_neighbors"
      severity: "critical"
      description: "BGP neighbor is down"

# Testing configuration
testing:
  enabled: true
  test_cases:
    - name: "connectivity_test"
      description: "Test end-to-end connectivity"
      source: "cloudpods-region"
      destination: "web-server"
      protocol: "ICMP"
      expected_result: "success"
      timeout: 30
    
    - name: "bgp_convergence_test"
      description: "Test BGP convergence time"
      protocol: "BGP"
      action: "withdraw_route"
      route: "192.168.3.0/24"
      expected_convergence_time: 30
      timeout: 60
    
    - name: "ospf_convergence_test"
      description: "Test OSPF convergence time"
      protocol: "OSPF"
      action: "link_failure"
      interface: "eth0"
      expected_convergence_time: 10
      timeout: 30
    
    - name: "traffic_shaping_test"
      description: "Test traffic shaping effectiveness"
      algorithm: "token_bucket"
      expected_rate: 100000  # bytes per second
      tolerance: 0.1         # 10% tolerance
      duration: 60           # seconds
    
    - name: "impairment_test"
      description: "Test network impairment effects"
      impairment: "packet_loss"
      expected_loss: 0.1     # 10% loss
      tolerance: 0.05        # 5% tolerance
      duration: 30           # seconds

# Performance benchmarks
benchmarks:
  enabled: true
  targets:
    - name: "packet_processing_rate"
      target: 1000000        # packets per second
      measurement: "packets_processed"
      duration: 60           # seconds
    
    - name: "route_convergence_time"
      target: 30             # seconds
      measurement: "convergence_time"
      protocol: "BGP"
    
    - name: "memory_usage"
      target: 512            # MB
      measurement: "memory_usage"
      duration: 300          # seconds
    
    - name: "cpu_usage"
      target: 80             # percentage
      measurement: "cpu_usage"
      duration: 300          # seconds

# Output configuration
output:
  log_file: "router_sim.log"
  metrics_file: "metrics.json"
  pcap_file: "traffic.pcap"
  report_file: "simulation_report.html"
  export_formats: ["json", "csv", "yaml"]
  
  visualization:
    enabled: true
    topology_graph: "topology.png"
    performance_charts: "performance.png"
    traffic_flows: "traffic_flows.png"
    protocol_timeline: "protocol_timeline.png"
