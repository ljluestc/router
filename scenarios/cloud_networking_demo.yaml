# Cloud Networking Demo Scenario
# Multi-Protocol Router Simulator with CloudPods Integration

name: "Cloud Networking Demo"
description: "Comprehensive cloud networking simulation with FRR integration, traffic shaping, and network impairments"
version: "1.0.0"

# Router Configuration
router:
  id: "cloud-router-01"
  name: "Cloud Networking Router"
  interfaces:
    - name: "eth0"
      ip: "10.0.1.1"
      mask: "255.255.255.0"
      type: "ethernet"
    - name: "eth1"
      ip: "10.0.2.1"
      mask: "255.255.255.0"
      type: "ethernet"
    - name: "lo"
      ip: "127.0.0.1"
      mask: "255.0.0.0"
      type: "loopback"

# Protocol Configuration
protocols:
  bgp:
    enabled: true
    local_as: "65001"
    router_id: "10.0.1.1"
    graceful_restart: true
    hold_time: 180
    keepalive_interval: 60
    neighbors:
      - ip: "10.0.1.2"
        as: "65002"
      - ip: "10.0.1.3"
        as: "65003"
      - ip: "10.0.2.2"
        as: "65004"

  ospf:
    enabled: true
    router_id: "10.0.1.1"
    areas:
      - "0.0.0.0"
      - "0.0.0.1"
    hello_interval: 10
    dead_interval: 40

  isis:
    enabled: true
    system_id: "1921.6800.1001"
    area_id: "49.0001"
    interfaces:
      - "eth0"
      - "eth1"
    level: 2
    hello_interval: 10
    hold_time: 30

# Traffic Shaping Configuration
traffic_shaping:
  token_bucket:
    rate_bps: 1000000000  # 1 Gbps
    burst_bytes: 10000000  # 10 MB

  wfq:
    total_bandwidth: 1000000000  # 1 Gbps
    queues:
      - name: "high_priority"
        weight: 8
        max_size: 1000000  # 1 MB
      - name: "medium_priority"
        weight: 4
        max_size: 500000   # 500 KB
      - name: "low_priority"
        weight: 2
        max_size: 250000   # 250 KB

# Network Impairments
impairments:
  delay:
    enabled: true
    ms: 10
    jitter: 2

  loss:
    enabled: true
    percent: 0.1

  duplicate:
    enabled: false
    percent: 0.0

  reorder:
    enabled: false
    percent: 0.0

  corruption:
    enabled: false
    percent: 0.0

  rate_limit:
    enabled: true
    bps: 500000000  # 500 Mbps

# Cloud Networking Configuration
cloud_networking:
  vpc:
    enabled: true
    name: "demo-vpc"
    cidr: "10.0.0.0/16"
    region: "us-west-2"

  subnets:
    - name: "public-subnet-1"
      cidr: "10.0.1.0/24"
      az: "us-west-2a"
    - name: "public-subnet-2"
      cidr: "10.0.2.0/24"
      az: "us-west-2b"
    - name: "private-subnet-1"
      cidr: "10.0.10.0/24"
      az: "us-west-2a"
    - name: "private-subnet-2"
      cidr: "10.0.20.0/24"
      az: "us-west-2b"

  load_balancers:
    - name: "web-lb"
      type: "application"
      subnet: "public-subnet-1"
    - name: "api-lb"
      type: "network"
      subnet: "public-subnet-2"

  nat_gateways:
    - name: "nat-gw-1"
      subnet: "public-subnet-1"
    - name: "nat-gw-2"
      subnet: "public-subnet-2"

  security_groups:
    - name: "web-sg"
      description: "Security group for web servers"
      rules:
        - direction: "ingress"
          protocol: "tcp"
          port_range_min: 80
          port_range_max: 80
          remote_ip_prefix: "0.0.0.0/0"
        - direction: "ingress"
          protocol: "tcp"
          port_range_min: 443
          port_range_max: 443
          remote_ip_prefix: "0.0.0.0/0"
    - name: "api-sg"
      description: "Security group for API servers"
      rules:
        - direction: "ingress"
          protocol: "tcp"
          port_range_min: 8080
          port_range_max: 8080
          remote_ip_prefix: "10.0.0.0/16"

  route_tables:
    - name: "public-rt"
      routes:
        - destination_cidr: "0.0.0.0/0"
          target_type: "internet_gateway"
          target_id: "igw-12345"
    - name: "private-rt-1"
      routes:
        - destination_cidr: "0.0.0.0/0"
          target_type: "nat_gateway"
          target_id: "nat-gw-1"
    - name: "private-rt-2"
      routes:
        - destination_cidr: "0.0.0.0/0"
          target_type: "nat_gateway"
          target_id: "nat-gw-2"

# Test Scenarios
test_scenarios:
  scenarios:
    - name: "basic_connectivity"
      description: "Test basic network connectivity"
      duration: 60
      packets_per_second: 1000
      packet_size: 64

    - name: "bgp_convergence"
      description: "Test BGP convergence time"
      duration: 120
      packets_per_second: 500
      packet_size: 1500

    - name: "ospf_hello"
      description: "Test OSPF hello packet exchange"
      duration: 30
      packets_per_second: 100
      packet_size: 64

    - name: "traffic_shaping"
      description: "Test traffic shaping algorithms"
      duration: 180
      packets_per_second: 2000
      packet_size: 1024

    - name: "network_impairments"
      description: "Test network impairment simulation"
      duration: 90
      packets_per_second: 1500
      packet_size: 512

    - name: "cloud_networking"
      description: "Test cloud networking features"
      duration: 300
      packets_per_second: 800
      packet_size: 1400

# Performance Benchmarks
benchmarks:
  - name: "routing_table_size"
    description: "Test routing table performance with large number of routes"
    max_routes: 1000000
    test_duration: 600

  - name: "packet_forwarding"
    description: "Test packet forwarding performance"
    packets_per_second: 10000000
    test_duration: 300

  - name: "protocol_convergence"
    description: "Test protocol convergence time"
    convergence_timeout: 30
    test_iterations: 100

# Monitoring and Analytics
monitoring:
  metrics:
    - name: "packet_count"
      type: "counter"
      description: "Total packets processed"
    
    - name: "bytes_forwarded"
      type: "counter"
      description: "Total bytes forwarded"
    
    - name: "routing_table_size"
      type: "gauge"
      description: "Current routing table size"
    
    - name: "protocol_peers"
      type: "gauge"
      description: "Number of active protocol peers"
    
    - name: "traffic_rate"
      type: "gauge"
      description: "Current traffic rate in bps"

  alerts:
    - name: "high_packet_loss"
      condition: "packet_loss > 1%"
      severity: "warning"
    
    - name: "routing_table_full"
      condition: "routing_table_size > 900000"
      severity: "critical"
    
    - name: "protocol_peer_down"
      condition: "protocol_peers < 2"
      severity: "warning"

# CloudPods Integration
cloudpods:
  enabled: true
  endpoint: "https://cloudpods.example.com:8080"
  username: "admin"
  password: "password"
  region: "us-west-2"
  project: "demo-project"
  timeout: 30

# Aviatrix Integration
aviatrix:
  enabled: true
  controller_ip: "192.168.1.100"
  username: "admin"
  password: "password"
  api_endpoint: "https://192.168.1.100:443"
  timeout: 30

# Terraform Provider Generation
terraform:
  enabled: true
  provider: "cloudpods"
  output_dir: "./terraform"
  variables:
    region: "us-west-2"
    environment: "demo"
    project: "router-sim"
  resources:
    - type: "cloudpods_vpc"
      name: "demo_vpc"
    - type: "cloudpods_subnet"
      name: "demo_subnet"
    - type: "cloudpods_security_group"
      name: "demo_sg"
    - type: "cloudpods_load_balancer"
      name: "demo_lb"
    - type: "cloudpods_nat_gateway"
      name: "demo_nat"

# Visualization and Demo
visualization:
  enabled: true
  web_interface: true
  real_time_updates: true
  network_topology:
    nodes:
      - id: "router-01"
        type: "router"
        position: { x: 100, y: 100 }
        label: "Cloud Router"
      - id: "vpc-01"
        type: "vpc"
        position: { x: 300, y: 100 }
        label: "Demo VPC"
      - id: "subnet-01"
        type: "subnet"
        position: { x: 400, y: 150 }
        label: "Public Subnet"
      - id: "subnet-02"
        type: "subnet"
        position: { x: 400, y: 200 }
        label: "Private Subnet"
      - id: "lb-01"
        type: "load_balancer"
        position: { x: 500, y: 175 }
        label: "Web LB"
    
    edges:
      - from: "router-01"
        to: "vpc-01"
        type: "bgp"
      - from: "vpc-01"
        to: "subnet-01"
        type: "routing"
      - from: "vpc-01"
        to: "subnet-02"
        type: "routing"
      - from: "subnet-01"
        to: "lb-01"
        type: "traffic"

  metrics_dashboard:
    - title: "Traffic Statistics"
      charts:
        - type: "line"
          metric: "packet_count"
          title: "Packets per Second"
        - type: "bar"
          metric: "bytes_forwarded"
          title: "Bytes Forwarded"
        - type: "gauge"
          metric: "routing_table_size"
          title: "Routing Table Size"
    
    - title: "Protocol Status"
      charts:
        - type: "status"
          metric: "bgp_peers"
          title: "BGP Peers"
        - type: "status"
          metric: "ospf_neighbors"
          title: "OSPF Neighbors"
        - type: "status"
          metric: "isis_adjacencies"
          title: "ISIS Adjacencies"
